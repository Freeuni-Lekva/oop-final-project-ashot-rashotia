<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Question Fragments</title>
</head>
<body>

<!-- QUESTION FRAGMENT -->
<div th:fragment="questionOptions(question)">
  <input type="hidden" name="questionIds" th:value="${question.id}" />

  <p><strong>Question:</strong> <span th:text="${question.question}">Question content</span></p>

  <!-- TestQuestion -->
  <div th:if="${question.getClass().simpleName == 'TestQuestion'}">
    <p>Choose the correct answer(s):</p>
    <ul>
      <li th:each="opt : ${question.savAnswers}">
        <label>
          <input type="checkbox"
                 th:name="${'answer_' + question.id}"
                 th:value="${opt}" />
          <span th:text="${opt}">Answer Option</span>
        </label>
      </li>
    </ul>
  </div>

  <!-- ResponseQuestion -->
  <div th:if="${question.getClass().simpleName == 'ResponseQuestion'}">
    <label th:for="${'answer_' + question.id}">Your Answer:</label>
    <input type="text"
           th:id="${'answer_' + question.id}"
           th:name="${'answer_' + question.id}"
           th:value="${question.userAnswer}"
           placeholder="Type your answer here..." />
  </div>

  <!-- FillBlankQuestion -->
  <div th:if="${question.getClass().simpleName == 'FillBlankQuestion'}">
    <label th:for="${'answer_' + question.id}">Your Answer:</label>
    <input type="text"
           th:id="${'answer_' + question.id}"
           th:name="${'answer_' + question.id}"
           th:value="${question.userAnswer}"
           placeholder="Type your answer here..." />
  </div>

  <!-- MatchingQuestion -->
  <div th:if="${question.getClass().simpleName == 'MatchingQuestion'}">
    <p><strong>Match the items:</strong></p>
    <table>
      <thead>
      <tr>
        <th>Left</th>
        <th>Match with</th>
      </tr>
      </thead>
      <tbody>
      <tr th:each="leftItem, iterStat : ${question.leftItems}">
        <td th:text="${leftItem}">Left</td>
        <td>
          <select th:name="${'answer_' + question.id + '_' + iterStat.index}">
            <option value="">-- Select --</option>
            <option th:each="rightItem : ${question.rightItems}"
                    th:value="${rightItem}"
                    th:text="${rightItem}"
                    th:selected="${question.userMatches.size() > iterStat.index
                                    and question.userMatches[iterStat.index] == rightItem}">
            </option>
          </select>
        </td>
      </tr>
      </tbody>
    </table>
  </div>

  <!-- MultiSelectQuestion -->
  <div th:if="${question.getClass().simpleName == 'MultiSelectQuestion'}">
    <p>Select all correct options:</p>
    <ul>
      <li th:each="opt : ${question.options}">
        <label>
          <input type="checkbox"
                 th:name="${'answer_' + question.id}"
                 th:value="${opt}"
                 th:checked="${#strings.contains(question.userAnswer, opt)}" />
          <span th:text="${opt}">Option</span>
        </label>
      </li>
    </ul>
  </div>

  <!-- MultiAnswerQuestion -->
  <div th:if="${question.getClass().simpleName == 'MultiAnswerQuestion'}">
    <p>Provide all answers (comma separated):</p>
    <input type="text"
           th:name="${'answer_' + question.id}"
           th:value="${question.userAnswer}"
           placeholder="Enter your answers separated by commas" />
  </div>

  <!-- PictureResponseQuestion -->
  <div th:if="${question.getClass().simpleName == 'PictureResponseQuestion'}">
    <p><strong th:text="${question.question}">Question</strong></p>
    <img th:src="@{${question.imageUrl}}" alt="Question image"
         style="max-width: 400px; max-height: 300px;" />
    <label th:for="${'answer_' + question.id}">Your Answer:</label>
    <input type="text"
           th:id="${'answer_' + question.id}"
           th:name="${'answer_' + question.id}"
           th:value="${question.userAnswer}"
           placeholder="Type your answer here..." />
  </div>

  <!-- GradedQuestion -->
  <div th:if="${question.getClass().simpleName == 'GradedQuestion'}">
    <label th:for="${'answer_' + question.id}">Your Answer:</label>
    <textarea th:id="${'answer_' + question.id}"
              th:name="${'answer_' + question.id}"
              placeholder="Enter your response here...">[[${question.userAnswer}]]</textarea>
    <div th:if="${question.graded}">
      <p><strong>Score:</strong> <span th:text="${question.score}">0</span></p>
      <p><strong>Feedback:</strong> <span th:text="${question.feedback}">No feedback</span></p>
    </div>
  </div>

  <!-- AutoGeneratedQuestion -->
  <div th:if="${question.getClass().simpleName == 'AutoGeneratedQuestion'}">
    <p><strong th:text="${question.question}">Auto-generated question</strong></p>
    <label th:for="${'answer_' + question.id}">Your Answer:</label>
    <input type="text"
           th:id="${'answer_' + question.id}"
           th:name="${'answer_' + question.id}"
           th:value="${question.userAnswer}"
           placeholder="Type your answer here..." />
  </div>
</div>

</body>
</html>
